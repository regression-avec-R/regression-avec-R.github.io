<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Régression avec R - 7 Choix de variables</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../correction/chap8.html" rel="next">
<link href="../correction/chap6.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Correction des exercices</li><li class="breadcrumb-item"><a href="../correction/chap7.html">III Réduction de dimension</a></li><li class="breadcrumb-item"><a href="../correction/chap7.html">7 Choix de variables</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Recherche" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Régression avec R</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Basculer en mode lecteur">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3ème édition</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../donnees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Jeux de données</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Codes R</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">I Introduction au modèle linéaire</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/chap1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1 Régression simple</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/chap2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2 La régression linéaire multiple</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/chap3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3 Validation du modèle</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">II Inférence</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/chap5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5 Inférence dans le modèle Gaussien</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/chap6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6 Variables qualitatives : ANCOVA et ANOVA</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">III Réduction de dimension</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/chap7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7 Choix de variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/chap8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8 Régularisation des moindres carrés : Ridge, Lasso et elastic net</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/chap9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9 Régression sur composantes : PCR et PLS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/chap10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10 Comparaison des différentes méthodes, étude de cas réels</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">IV Le modèle linéairé généralisé</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/chap11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11 Régression logistique</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/chap12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12 Régression de Poisson</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/chap13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13 Régularisation de la vraisemblance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/chap15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15 Données déséquilibrées</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">V Introduction à la régression non paramétrique</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/chap16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16 Introduction à la régression spline</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/chap17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">17 Estimateurs à noyau et <span class="math inline">\(k\)</span> plus proches voisins</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Correction des exercices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
 <span class="menu-text">I Introduction au modèle linéaire</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correction/chap1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1 La régression linéaire simple</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correction/chap2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2 La régression linéaire multiple</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correction/chap3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3 Validation du modèle</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correction/chap4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4 Extensions : non-inversibilité et (ou) erreurs corrélées</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">
 <span class="menu-text">II Inférence</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correction/chap5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5 Inférence dans le modèle gaussien</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correction/chap6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6 Variables qualitatives : ANCOVA et ANOVA</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
 <span class="menu-text">III Réduction de dimension</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correction/chap7.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">7 Choix de variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correction/chap8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8 Régularisation des moindre carrés : Ridge, Lasso et elastic net</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correction/chap9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9 Régression sur composantes : PCR et PLS</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false">
 <span class="menu-text">IV Le modèle linéairé généralisé</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correction/chap11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11 Régression logistique</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correction/chap12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12 Régression de Poisson</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correction/chap13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13 Régularisation de la vraisemblance</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false">
 <span class="menu-text">V Introduction à la régression non paramétrique</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correction/chap17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">17 Estimateurs à noyau et <span class="math inline">\(k\)</span> plus proches voisins</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">7 Choix de variables</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">

</div>
<div id="exr-7-1" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 1 (Questions de cours) </strong></span>A, C, B en général. Un cas particulier de la dernière question est le suivant : si les variables sélectionnées <span class="math inline">\(\xi\)</span> engendrent un sous-espace orthogonal au sous-espace engendré par les variables non sélectionnées <span class="math inline">\(\bar\xi\)</span>, alors C est la bonne réponse.</p>
</div>
<div id="exr-7-2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 2 (Analyse du biais) </strong></span>La preuve des deux premiers points s’effectue comme l’exemple de la section 7.2.1. Nous ne détaillerons que le premier point. Supposons que <span class="math inline">\(|\xi|\)</span> soit plus petit que <span class="math inline">\(p\)</span>, le “vrai” nombre de variables entrant dans le modèle. Nous avons pour estimateur de <span class="math inline">\(\beta\)</span> <span class="math display">\[
\hat \beta_{\xi} = (X_{\xi}'X_{\xi})^{-1}X_{\xi}'Y = P_{X_{\xi}}Y.
\]</span> Le vrai modèle étant obtenu avec <span class="math inline">\(p\)</span> variables, <span class="math inline">\(\mathbf E(Y)=X_p \beta\)</span>. Nous avons alors <span class="math display">\[
\begin{eqnarray*}
\mathbf E(\hat \beta_{\xi})&amp;=&amp;P_{X_{\xi}}X_p \beta\\
&amp;=&amp; P_{X_{\xi}}X_{\xi} \beta_{\xi} +P_{X_{\xi}}X_{\bar \xi} \beta_{\bar \xi}.
\end{eqnarray*}
\]</span> Cette dernière quantité n’est pas nulle sauf si <span class="math inline">\(\Im(X_{\xi}) \perp \Im(X_{\bar \xi})\)</span>. Comme <span class="math inline">\(\hat \beta_{\xi}\)</span> est en général biaisé, il en est de même pour la valeur prévue <span class="math inline">\(\hat y_{\xi}\)</span> dont l’espérance ne vaudra pas <span class="math inline">\(X\beta\)</span>.</p>
</div>
<div id="exr-7-3" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 3 (Variance des estimateurs) </strong></span>L’estimateur obtenu avec les <span class="math inline">\(|\xi|\)</span> variables est noté <span class="math inline">\(\hat \beta_{\xi}\)</span> et l’estimateur obtenu dans le modèle complet <span class="math inline">\(\hat \beta\)</span>. Ces vecteurs ne sont pas de même taille, le premier est de longueur <span class="math inline">\(|\xi|\)</span>, le second de longueur <span class="math inline">\(p\)</span>. Nous comparons les <span class="math inline">\(|\xi|\)</span> composantes communes, c’est-à-dire que nous comparons <span class="math inline">\(\hat \beta_{\xi}\)</span> et <span class="math inline">\([\hat \beta]_{\xi}\)</span>. Partitionnons la matrice <span class="math inline">\(X\)</span> en <span class="math inline">\(X_{\xi}\)</span> et <span class="math inline">\(X_{\bar \xi}\)</span>. Nous avons alors <span class="math display">\[
\begin{eqnarray*}
\mathop{\mathrm{V}}(\hat \beta) &amp;=&amp; \sigma^2 \left(
\begin{array}{cc}
X'_{\xi}X_{\xi} &amp;X'_{\xi}X_{\bar \xi}\\
X'_{\bar \xi}X_{\xi} &amp;X'_{\bar \xi}X_{\bar \xi}
\end{array}
\right)^{-1}.
\end{eqnarray*}
\]</span> En utilisant la formule d’inverse par bloc, donnée en annexe A, nous obtenons <span class="math display">\[
\begin{eqnarray*}
\mathop{\mathrm{V}}([\hat \beta]_{\xi}) &amp;=&amp; \sigma^2 \left[X_{\xi}'X_{\xi}-X_{\xi}'X_{\bar \xi}(X_{\bar \xi}'
X_{\bar \xi})^{-1}X_{\bar \xi}'X_{\xi}\right]^{-1},
\end{eqnarray*}
\]</span> alors que la variance de <span class="math inline">\(\hat \beta_{\xi}\)</span> vaut <span class="math display">\[
\begin{eqnarray*}
\mathop{\mathrm{V}}(\hat \beta_{\xi}) &amp;=&amp; \sigma^2 \left[X_{\xi}'X_{\xi}\right]^{-1}.
\end{eqnarray*}
\]</span> Nous devons comparer <span class="math inline">\(\mathop{\mathrm{V}}([\hat \beta]_{\xi})\)</span> et <span class="math inline">\(\mathop{\mathrm{V}}(\hat \beta_{\xi})\)</span>. Nous avons <span class="math display">\[
\begin{eqnarray*}
X_{\xi}'X_{\xi}-X_{\xi}'X_{\bar \xi}(X_{\bar \xi}'
X_{\bar \xi})^{-1}X_{\bar \xi}'X_{\xi}=X_{\xi}'(I-P_{X_{\bar \xi}})X_{\xi}
=X_{\xi}'P_{X_{\bar \xi}^\perp}X_{\xi}.
\end{eqnarray*}
\]</span> La matrice <span class="math inline">\(P_{X_{\bar \xi}^\perp}\)</span> est la matrice d’un projecteur, alors elle est semi-définie positive (SDP) (cf.&nbsp;annexe A), donc <span class="math inline">\(X_{\xi}'P_{X_{\bar \xi}^\perp}X_{\xi}\)</span> est également SDP. La matrice <span class="math inline">\(X_{\xi}'P_{X_{\bar \xi}^\perp}X_{\xi}-X_{\xi}'P_{X_{\bar \xi}^\perp}X_{\xi}\)</span> est définie positive (DP) puisque c’est <span class="math inline">\(\mathop{\mathrm{V}}([\hat \beta]_{\xi})/ \sigma^2\)</span>. Utilisons le changement de notation suivant : <span class="math display">\[
\begin{eqnarray*}
A=X_{\xi}'X_{\xi}-X_{\xi}'P_{X_{\bar \xi}}X_{\xi} \quad \hbox{et} \quad
B=X_{\xi}'P_{X_{\bar \xi}}X_{\xi}.
\end{eqnarray*}
\]</span> La matrice <span class="math inline">\(A\)</span> est DP et la matrice <span class="math inline">\(B\)</span> SDP. La propriété donnée en annexe A indique que <span class="math inline">\(A^{-1}-(A+B)^{-1}\)</span> est SDP, or <span class="math display">\[
\begin{eqnarray*}
\mathop{\mathrm{V}}([\hat \beta]_{\xi})-\mathop{\mathrm{V}}(\hat \beta_{\xi}) = \sigma^2 (A^{-1}-(A+B)^{-1}).
\end{eqnarray*}
\]</span> Donc la quantité <span class="math inline">\(\mathop{\mathrm{V}}([\hat \beta]_{\xi})-\mathop{\mathrm{V}}(\hat \beta_{\xi})\)</span> est SDP. Le résultat est démontré. L’estimation, en terme de variance, de <span class="math inline">\(\xi\)</span> composantes est plus précise que les mêmes <span class="math inline">\(\xi\)</span> composantes extraites d’une estimation obtenue avec <span class="math inline">\(p\)</span> composantes.</p>
<p>La variance des valeurs ajustées dépend de la variance de <span class="math inline">\(\hat \beta\)</span>, le point 2 de la proposition se démontre de façon similaire.</p>
<p><strong>Remarque</strong> : nous venons de comparer deux estimateurs de même taille <em>via</em> leur matrice de variance. Pour cela, nous montrons que la différence de ces deux matrices est une matrice SDP. Que pouvons-nous dire alors sur la variance de chacune des coordonnées ? Plus précisément, pour simplifier les notations, notons le premier estimateur (de taille <span class="math inline">\(p\)</span>) <span class="math inline">\(\tilde \beta\)</span> de variance <span class="math inline">\(\mathop{\mathrm{V}}(\tilde \beta)\)</span> et le second estimateur <span class="math inline">\(\hat \beta\)</span> de variance <span class="math inline">\(\mathop{\mathrm{V}}(\hat \beta)\)</span>. Si <span class="math inline">\(\mathop{\mathrm{V}}(\tilde \beta)-\mathop{\mathrm{V}}(\hat \beta)\)</span> est SDP, pouvons-nous dire que <span class="math inline">\(\mathop{\mathrm{V}}(\tilde \beta_i)-\mathop{\mathrm{V}}(\hat \beta_i)\)</span> est un nombre positif pour <span class="math inline">\(i\)</span> variant de <span class="math inline">\(1\)</span> à <span class="math inline">\(p\)</span> ? Considérons par exemple le vecteur <span class="math inline">\(u_1'=(1,0,\dotsc,0)\)</span> de <span class="math inline">\(\mathbb R^p\)</span>. Nous avons alors <span class="math display">\[
u_1' \hat \beta = \hat \beta_1 \quad \hbox{et}
\quad u_1' \tilde \beta = \tilde \beta_1.
\]</span> Comme <span class="math inline">\(\mathop{\mathrm{V}}(\tilde \beta)-\mathop{\mathrm{V}}(\hat \beta)\)</span> est SDP, nous avons pour tout vecteur <span class="math inline">\(u\)</span> de <span class="math inline">\(\mathbb R^p\)</span> que <span class="math inline">\(u'(\mathop{\mathrm{V}}(\tilde \beta)-\mathop{\mathrm{V}}(\hat \beta))u\geq 0\)</span>, c’est donc vrai en particulier pour <span class="math inline">\(u_1\)</span>. Nous avons donc <span class="math display">\[
\begin{eqnarray*}
u_1'(\mathop{\mathrm{V}}(\tilde \beta)-\mathop{\mathrm{V}}(\hat \beta))u_1&amp;\geq&amp; 0\\
u_1'\mathop{\mathrm{V}}(\tilde \beta)u_1-u_1'\mathop{\mathrm{V}}(\hat \beta)u_1&amp;\geq&amp; 0\\
\mathop{\mathrm{V}}(u_1'\tilde \beta)-\mathop{\mathrm{V}}(u_1'\hat \beta)&amp;\geq&amp; 0\\
\mathop{\mathrm{V}}(\tilde \beta_1) &amp;\geq &amp; \mathop{\mathrm{V}}(\hat \beta_1).
\end{eqnarray*}
\]</span> Nous pouvons retrouver ce résultat pour les autres coordonnées des vecteurs estimés ou encore pour des combinaisons linéaires quelconques de ces coordonnées.</p>
</div>
<div id="exr-7-4" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 4 (Choix de variables) </strong></span>Tous les modèles possibles ont été étudiés, la recherche est donc exhaustive. En prenant comme critère l’AIC ou le BIC, le modèle retenu est le modèle M134. Comme prévu, le <span class="math inline">\(\mathop{\mathrm{R^2}}\)</span> indique le modèle conservant toutes les variables. Cependant le <span class="math inline">\(\mathop{\mathrm{R^2}}\)</span> peut être utilisé pour tester des modèles emboîtés. Dans ce cas, le modèle retenu est également le M134.</p>
<p>Pour une procédure avec test nous devons démarrer d’un modèle. Démarrons par exemple du modèle avec uniquement la constante. Nous ajoutons une variable après l’autre. Nous ajoutons celle avec la statistique de test la plus élevée et cette valeur doit être plus grande que 2.3 (sinon aucune variable n’est ajoutée et le modèle courant est conservé). Dans les modèles à une variable, c’est le modèle M1 qui est choisi (statistique la plus élevée de 41.9 et supérieure à 2.3). Ensuite nous ajoutons à M1 une variable (2 ou 3 ou 4) et la meilleure est la 4 mais la statistique est de 0.9 (&lt; 2.3) on n’ajoute pas de variable et on choisit M1.</p>
<p>Démarrons du modèle complet 1234, on enlève la moins significative (la valeur de la statistique de test la plus faible en dehors de la constante et qui doit être plus faible que 2.3). Ici nous enlevons la variable 2 et nous avons donc le modèle M134. Dans ce modèle la variable la moins significative est la 3 mais sa statistique est plus grande que 2.3, on conserve donc le modèle M134.</p>
</div>
<div id="exr-7-5" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 5 (Utilisation du <span class="math inline">\(R^2\)</span>) </strong></span>Plaçons nous dans le cas pratique où la constante fait partie des modèles, elle est donc dans une des colonnes de <span class="math inline">\(Z\)</span> (par exemple la première). Le <span class="math inline">\(\mathop{\mathrm{R^2}}\)</span> est par définition <span class="math display">\[
\begin{align*}
\mathop{\mathrm{R^2}}(Z)&amp;=\frac{\|P_{Z}Y - P_{\mathbf{1}}Y\|^{2}}{\|Y - P_{\mathbf{1}}Y\|^{2}}\\
\mathop{\mathrm{R^2}}(X)&amp;=\frac{\|P_{X}Y - P_{\mathbf{1}}Y\|^{2}}{\|Y - P_{\mathbf{1}}Y\|^{2}}
\end{align*}
\]</span> Comme <span class="math inline">\(\Im(Z)\subset \Im(X)\)</span> on peut décomposer en deux <span class="math inline">\(\Im(X)\)</span>: la partie <span class="math inline">\(\Im(Z)\)</span> puis le reste ce qui se note <span class="math display">\[
\Im(X)=\Im(Z) \stackrel{\perp}{\oplus} (\Im(X)\cap \Im(Z)^{\perp})
\]</span> Au niveau des projecteurs on a donc <span class="math display">\[
P_{X}=P_{Z} + P_{X\cap Z^{\perp}}
\]</span> ce qui permet d’écrire le <span class="math inline">\(\mathop{\mathrm{R^2}}\)</span> du modèle avec <span class="math inline">\(X\)</span> comme suit puis par pythagore (<span class="math inline">\((P_{Z}Y - P_{\mathbf{1}}Y)\in \Im(Z)\)</span> et <span class="math inline">\(P_{X\cap Z^{\perp}}Y\in \Im(Z)^{\perp}\)</span>) <span class="math display">\[
\begin{align*}
\mathop{\mathrm{R^2}}(X)&amp;=\frac{\|P_{Z}Y + P_{X\cap Z^{\perp}}Y - P_{\mathbf{1}}Y\|^{2}}{\|Y - P_{\mathbf{1}}Y\|^{2}} \\
&amp;= \frac{\|(P_{Z}Y - P_{\mathbf{1}}Y) + P_{X\cap Z^{\perp}}Y \|^{2}}{\|Y - P_{\mathbf{1}}Y\|^{2}}\\
&amp;=\frac{\|(P_{Z}Y - P_{\mathbf{1}}Y) \|^{2}}{\|Y - P_{\mathbf{1}}Y\|^{2}} + \frac{\|P_{X\cap Z^{\perp}}Y \|^{2}}{\|Y - P_{\mathbf{1}}Y\|^{2}}= \mathop{\mathrm{R^2}}2(Z) + \frac{\|P_{X\cap Z^{\perp}}Y \|^{2}}{\|Y - P_{\mathbf{1}}Y\|^{2}}
\end{align*}
\]</span> Comme la seconde partie est positive ou nulle on a que <span class="math inline">\(\mathop{\mathrm{R^2}}(X)\)</span> est au moins aussi grand que <span class="math inline">\(\mathop{\mathrm{R^2}}(Z)\)</span>. Il y a égalité dans le cas rare où <span class="math inline">\(Y\perp (\Im(X)\cap \Im(Z)^{\perp})\)</span> c’est à dire que l’on a ajouté des variables qui ne sont pas entièrement reliées aux variables de <span class="math inline">\(Z\)</span> mais dont la partie non redondante avec celle de <span class="math inline">\(Z\)</span> (qui existe car le rang de <span class="math inline">\(X\)</span> est <span class="math inline">\(p\)</span>) a une corrélation empirique avec <span class="math inline">\(Y\)</span> de 0 exactement. Comme le <span class="math inline">\(\mathop{\mathrm{R^2}}\)</span> augmente en ajoutant des variables le modèle sélectionné sera celui avec toutes les variables.</p>
<p>Donc si nous cherchons à expliquer la concentration d’ozone à Rennes et si nous avons en même temps la consommation de nouille au Viêt Nam les mêmes jours, le <span class="math inline">\(\mathop{\mathrm{R^2}}\)</span> nous conduira à sélectionner aussi la consommation de nouille au Viet-Nam comme variable explicative, variable dont on sent le peu d’influence sur la concentration d’ozone.</p>
</div>
<div id="exr-7-6" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 6 (Cas orthogonal) </strong></span>&nbsp;</p>
<ol type="1">
<li><p>Les variables sont orthogonales donc on a <span class="math inline">\(X'X=I_{p}\)</span> et l’estimateur des MCO s’écrit <span class="math display">\[
\hat \beta=(X'X)^{-1}X'Y=X'Y
\]</span> En remplaçant <span class="math inline">\(Y\)</span> par le modèle (<span class="math inline">\(Y=X\beta + \varepsilon\)</span>) on a <span class="math display">\[
\hat \beta=X'X\beta + X'\varepsilon = \beta + X'\varepsilon.
\]</span></p></li>
<li><p>La somme des résidus vaut ici <span class="math display">\[
\begin{align*}
\mathop{\mathrm{SCR}}&amp;=\|Y-X\hat\beta\|^{2}=(Y-X\hat\beta)'(Y-X\hat\beta)= Y'Y - 2Y'X\hat\beta + \hat\beta'X'X\hat\beta\\
&amp;= \sum_{i=1}^n y_{i}^2- 2Y'X\hat\beta + \hat\beta'X'X\hat\beta.
\end{align*}
\]</span> Évaluons le second terme du membre de droite: comme <span class="math inline">\(X\hat\beta=P_{X}Y\)</span> et en utilisant le fait que <span class="math inline">\(Y=P_{X}Y + P_{X^{\perp}}Y\)</span> on obtient <span class="math display">\[
Y'X\hat\beta= (P_{X}Y + P_{X^{\perp}}Y)'P_{X}Y= Y' P_{X}' P_{X}Y = \hat\beta'X'X\hat \beta
\]</span> car <span class="math inline">\(P_{X}Y\)</span> et <span class="math inline">\(P_{X^{\perp}}Y\)</span> sont orthogonaux et leur produit scalaire <span class="math inline">\(Y'P_{X^{\perp}}'P_{X}Y\)</span> vaut 0. On a donc <span class="math display">\[
\mathop{\mathrm{SCR}}=\sum_{i=1}^n y_{i}^2 - \hat\beta'X'X\hat \beta
\]</span> Comme ici la matrice <span class="math inline">\(X\)</span> est orthogonale on a <span class="math inline">\(X'X=I_{p}\)</span> et l’expression devient <span id="eq-scr-ortho"><span class="math display">\[
\mathop{\mathrm{SCR}}=\sum_{i=1}^n y_{i}^2 - \sum_{j=1}^p \hat \beta_{j}
\tag{1}\]</span></span> La somme du carré des résidus est d’autant plus faible que les coefficients estimés sont grands en valeur absolue.</p></li>
<li><p>Prenons un modèle <span class="math inline">\(\xi\)</span> qui regroupe les <span class="math inline">\(k\)</span> premières variables (ce qui est pratique pour les notations). Comme la matrice <span class="math inline">\(X\)</span> est orthogonale on a au niveau des sous espaces que toutes les variables engendrent des sous-espaces vectoriels orthogonaux que l’on peut regrouper: <span class="math display">\[
\begin{align*}
\Im(X) &amp;= \Im(X_{1})\stackrel{\perp}{\oplus} \Im(X_{2})\stackrel{\perp}{\oplus} \cdots \stackrel{\perp}{\oplus}\Im(X_{p})\\
&amp;= \Im(X_{\xi})\stackrel{\perp}{\oplus}\Im(X_{\bar\xi})
\end{align*}
\]</span> Ce qui donne au niveau des projecteurs <span class="math display">\[
P_{X}= P_{X_{\xi}} + P_{X_{\bar\xi}}
\]</span> Écrivons par ailleurs l’ajustement: <span class="math display">\[
\begin{align*}
P_{X}Y&amp;= X\hat \beta= X_{1}\hat \beta_{1} + X_{2}\hat \beta_{2} + \cdots +X_{p}\hat \beta_{p}\\
P_{X_{\xi}}Y + P_{X_{\bar\xi}}Y&amp;= X_{1}\hat \beta_{1} + X_{2}\hat \beta_{2} + \cdots +X_{p}\hat \beta_{p}
\end{align*}
\]</span> Si je projette sur <span class="math inline">\(\Im(X_{\xi})\)</span> l’équation ci-dessus cela nous donne (<span class="math inline">\(\Im(X_{\bar\xi})\subset \Im(X_{\xi})^{\perp}\)</span>) <span class="math display">\[
P_{X_{\xi}}Y= X_{1}\hat \beta_{1}  + \cdots +X_{k}\hat \beta_{k}
\]</span> Or nous savons que les MCO dans le modèle <span class="math inline">\(\xi\)</span> donne l’ajustement <span class="math inline">\(P_{X_{\xi}}Y=X_{\xi}\hat\beta_{\xi}\)</span> qui est unique, ce qui donne en identifiant les deux écritures que <span class="math display">\[
X_{1}\hat \beta_{1}  + \cdots +X_{k}\hat \beta_{k}= X_{\xi}
\]</span> Comme une base de <span class="math inline">\(\Im(X_{\bar\xi})\)</span> est donnée par les colonnes orthonormées de <span class="math inline">\(X_{\xi}\)</span> on en déduit que les coefficients dans la base sont uniques d’où <span class="math display">\[
[\hat \beta]_{\xi}= \hat\beta_{\xi}.
\]</span></p></li>
<li><p>Les critères AIC et BIC valent pour le modèle <span class="math inline">\(\xi\)</span> <span class="math display">\[
-2\mathcal{L} + 2 |\xi + 1| f(n)
\]</span> et quand on compare le modèle <span class="math inline">\(\xi\)</span> et le modèle <span class="math inline">\(\{\xi, l\}\)</span> on compare donc <span class="math display">\[
-2\mathcal{L}(\xi) + 2 |\xi + 1| f(n) \ \ \mathrm{et} \ \ -2\mathcal{L}(\{\xi, l\}) + 2 |\xi + 2| f(n)
\]</span> Comme <span class="math inline">\(\mathcal{L}(\xi)\)</span> vaut <span class="math inline">\(-{n}/{2}\log\sigma^{2} -{n}/{2}-{1}/{2\sigma^{2}}.\mathop{\mathrm{SCR}}(\xi)\)</span> lorsque l’on compare on peut éliminer les termes identiques et il reste donc <span class="math display">\[
\frac{1}{\sigma^{2}}\mathop{\mathrm{SCR}}(\xi) \ \ \mathrm{et} \ \  \frac{1}{\sigma^{2}}\mathop{\mathrm{SCR}}(\{\xi, l\}) + 2  f(n)
\]</span> Effectuons la différence: <span class="math display">\[
\Delta =  \frac{1}{\sigma^{2}}(\mathop{\mathrm{SCR}}(\{\xi, l\}) - \mathop{\mathrm{SCR}}(\xi)) + 2  f(n)
\]</span> et en utilisant <a href="#eq-scr-ortho">équation&nbsp;1</a> et la question 3 on obtient <span class="math display">\[
\begin{align*}
\Delta &amp;= \frac{1}{\sigma^{2}}(\sum_{i=1}^n y_{i}^2 - \sum_{\xi} \hat \beta_{j}^2 - \hat \beta_{l}^2 - \sum_{i=1}^n y_{i}^2 + \sum_{\xi} \hat \beta_{j}^2)+ 2  f(n)\\
&amp;= -\frac{\hat \beta_{l}^2}{\sigma^{2}} + 2f(n)
\end{align*}
\]</span> Quand <span class="math inline">\(\Delta\)</span> est négatif l’AIC (ou le BIC) du modèle <span class="math inline">\(\{\xi, l\}\)</span> est plus faible que l’AIC (ou le BIC) que celui du modèle <span class="math inline">\(\xi\)</span>, c’est à dire que l’AIC (ou le BIC) du modèle <span class="math inline">\(\{\xi, l\}\)</span> est meilleur: on ajoute la variable <span class="math inline">\(l\)</span>. Cela donne donc <span class="math display">\[
\begin{align*}
\Delta &amp; &lt; 0\\
-\frac{\hat \beta_{l}^2}{\sigma^{2}} + 2f(n) &amp; &lt; 0\\
\frac{\hat \beta_{l}^2}{\sigma^{2}}&amp;&gt; 2f(n)
\end{align*}
\]</span></p></li>
<li><p>En écrivant que <span class="math display">\[
N=\frac{\mathop{\mathrm{SCR}}(\xi) - \mathop{\mathrm{SCR}}(\{\xi, l\})}{\sigma^{2}}
\]</span> nous voyons qu’il faut évaluer la différence des SCR. En utilisant <a href="#eq-scr-ortho">équation&nbsp;1</a> et la question 3 on a <span class="math display">\[
\begin{align*}
\mathop{\mathrm{SCR}}(\xi) - \mathop{\mathrm{SCR}}(\{\xi, l\})&amp;=\sum_{i=1}^n y_{i}^2  -  \sum_{\xi} \hat \beta_{j}^2 - \sum_{i=1}^n y_{i}^2 + \sum_{\xi} \hat \beta_{j}^2 + \hat \beta_{l}^2  \\
&amp;= \hat \beta_{l}^2
\end{align*}
\]</span> Nous en déduisons la valeur de <span class="math inline">\(N\)</span> (la dernière égalité découle du calcul de <span class="math inline">\(\hat \beta\)</span> en question 1) <span class="math display">\[
N=\frac{\hat\beta_{l}^{2}}{\sigma^{2}}= \frac{(\beta_{l} + [X' \varepsilon]_{l})^{2}}{\sigma^{2}}
\]</span> Le dernier membre nous indique que la partie aléatoire est <span class="math inline">\([X' \varepsilon]_{l}\)</span>. D’après <span class="math inline">\({\mathcal{H}}_{3}\)</span> on a que <span class="math inline">\(X' \varepsilon\)</span> est gaussien d’espérance <span class="math inline">\(\mathbf E(X'\varepsilon)=X'\mathbf E(\varepsilon)=0\)</span> et de variance <span class="math inline">\(\mathop{\mathrm{V}}(X'\varepsilon)=X'\mathop{\mathrm{V}}(\varepsilon)X=\sigma^{2}I_{p}\)</span>. Sa coordonnée <span class="math inline">\(l\)</span> notée <span class="math inline">\([X' \varepsilon]_{l}\)</span> est donc une loi normale <span class="math inline">\({\mathcal{N}}(0, \sigma^{2})\)</span> et on en déduit que <span class="math display">\[
\frac{\hat \beta_{l}}{\sigma} \sim {\mathcal{N}}(\frac{\beta_{l}}{\sigma}, 1).
\]</span> Le carré de cette loi normale (noté <span class="math inline">\(N\)</span>) est donc un <span class="math inline">\(\chi^{2}(1)\)</span> décentré de paramètre de décentrage <span class="math inline">\({\beta_{l}^{2}}/{\sigma^{2}}\)</span>. On connait donc la loi de la statistique de test <span class="math inline">\(N\)</span> (un <span class="math inline">\(\chi^{2}(1)\)</span> décentré de paramètre de décentrage <span class="math inline">\(\beta_{l}^{2}\)</span>). Quand <span class="math inline">\({\mathrm{H_0}}\)</span> est vrai, c’est-à-dire le modèle <span class="math inline">\(\xi\)</span> est valide, il n’y a pas la variable <span class="math inline">\(l\)</span> dans le modèle, donc <span class="math inline">\(\beta_{l}=0\)</span> et le paramètre de décentrage vaut <span class="math inline">\(0\)</span>. Le seuil de rejet basé sur la statistique <span class="math inline">\(N\)</span> est son quantile de niveau 0.95 sous <span class="math inline">\({\mathrm{H_0}}\)</span>’ c’est à dire celui d’un <span class="math inline">\(\chi^{2}(1)\)</span> à 0.95 :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qchisq</span>(<span class="fl">0.95</span>, <span class="at">df=</span><span class="dv">1</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.841459</code></pre>
</div>
</div></li>
<li><p>Par définition le <span class="math inline">\(\mathop{\mathrm{R^2_a}}\)</span> vaut <span class="math display">\[
\mathop{\mathrm{R^2_a}}(\xi) =1-\frac{n-1}{\mathop{\mathrm{SCT}}}\frac{\mathop{\mathrm{SCR}}(\xi)}{n-|\xi|}
\]</span> Calculons la différence des <span class="math inline">\(\mathop{\mathrm{R^2_a}}\)</span> <span class="math display">\[
\Delta\mathop{\mathrm{R^2_a}}= \frac{n-1}{\mathop{\mathrm{SCT}}}(\frac{\mathop{\mathrm{SCR}}(\xi)}{n-|\xi|} - \frac{\mathop{\mathrm{SCR}}(\{\xi, l\})}{n-|\xi| -1})
\]</span> Cette différence est positive (on ajoute la variable <span class="math inline">\(l\)</span>) si <span class="math display">\[
\begin{align*}
\frac{\mathop{\mathrm{SCR}}(\xi)}{n-|\xi|} - \frac{\mathop{\mathrm{SCR}}(\{\xi, l\})}{n-|\xi| -1}&amp;&gt;0\\
\frac{\mathop{\mathrm{SCR}}(\xi)}{n-|\xi|}- \frac{\mathop{\mathrm{SCR}}(\xi) -\hat\beta^{2}_{l} }{n-|\xi| -1}&amp;&gt;0\\
\frac{\mathop{\mathrm{SCR}}(\xi)}{n-|\xi|} - \frac{\mathop{\mathrm{SCR}}(\xi)}{n-|\xi|}.\frac{n-|\xi|}{n-|\xi|-1}+ \frac{\hat\beta^{2}_{l}}{n-|\xi| -1} &amp;&gt;0\\
\frac{\mathop{\mathrm{SCR}}(\xi)}{n-|\xi|}\frac{-1}{n-|\xi| -1}+ \frac{\hat\beta^{2}_{l}}{n-|\xi| -1}&amp;&gt;0
\end{align*}
\]</span> En utilisant l’approximation on a donc approximativement <span class="math display">\[
\begin{align*}
   \frac{1}{n-|\xi| -1}(\hat\beta^{2}_{l}- \sigma^{2})  &amp;&gt;0\\
  \frac{\sigma^{2}}{n-|\xi| -1} (\frac{\hat\beta^{2}_{l}}{\sigma^{2}}- 1)&amp;&gt;0\\
\end{align*}
\]</span> Le premier terme étant positif on retrouve que <span class="math display">\[
\begin{align*}
\frac{\hat\beta^{2}_{l}}{\sigma^{2}}- 1&amp;&gt;0\\
\frac{\hat\beta^{2}_{l}}{\sigma^{2}}&amp;&gt;1.
\end{align*}
\]</span></p></li>
<li><p>Comme <span class="math display">\[
\mathop{\mathrm{C_p}}(\xi)=\frac{\mathop{\mathrm{SCR}}(\xi)}{\sigma^2}-n+2|\xi|.
\]</span> on fait là encore la différence des <span class="math inline">\(\mathop{\mathrm{C_p}}\)</span> <span class="math display">\[
\begin{align*}
\Delta\mathop{\mathrm{C_p}}&amp;= \frac{\mathop{\mathrm{SCR}}(\{\xi, l\})-\mathop{\mathrm{SCR}}(\xi)}{\sigma^2}+2 =
\frac{\mathop{\mathrm{SCR}}(\xi) -\hat\beta^{2}_{l} -\mathop{\mathrm{SCR}}(\xi)}{\sigma^2} +2\\
&amp;=-\frac{\hat\beta^{2}_{l}}{\sigma^2} +2
\end{align*}
\]</span> Cette différence est négative (on ajoute la variable <span class="math inline">\(l\)</span>) si <span class="math display">\[
-\frac{\hat\beta^{2}_{l}}{\sigma^2} +2&lt;0 \quad\Longleftrightarrow\quad
\frac{\hat\beta^{2}_{l}}{\sigma^2}&gt;2.
\]</span></p></li>
<li><p>D’après la question 3 nous n’avons besoin d’estimer qu’une fois le modèle complet et les coordonnées donnent les estimateurs dans les modèles restreints.</p>
<p><strong>Algorithme</strong> :</p>
<ol type="1">
<li><p>Estimer <span class="math inline">\(\beta\)</span> dans le modèle complet <span class="math inline">\(\hat \beta = X'Y\)</span> .</p></li>
<li><p>Déduire <span class="math inline">\(\hat\sigma^{2}\)</span> dans le modèle complet <span class="math inline">\(\hat\sigma^{2}=\|Y - X\hat \beta\|^{2}/(n-p)\)</span> .</p></li>
<li><p>Ordonner les coordonnées dans l’ordre décroissant: <span class="math display">\[
\hat \beta_{{(1)}} \geq \hat \beta_{{(2)}}\geq \cdots \geq \hat \beta_{{(p)}}.
\]</span> Les colonnes correspondantes seront notées <span class="math inline">\((k)\)</span>.</p></li>
<li><p>Pour <span class="math inline">\(k=1\)</span> à <span class="math inline">\(p\)</span></p>
<ul>
<li>Si <span class="math inline">\(\frac{\hat\beta^{2}_{(k)}}{\hat\sigma^2}\)</span> &gt; Seuil alors ajout la variable <span class="math inline">\((k)\)</span></li>
<li>Sinon Sortie de la boucle, plus de variable à ajouter</li>
</ul>
<p>Le seuil vaut <span class="math inline">\(2f(n)\)</span> pour l’AIC et le BIC, il vaut 3.84 pour un test, 1 pour le <span class="math inline">\(\mathop{\mathrm{R^2_a}}\)</span> et 2 pour le <span class="math inline">\(\mathop{\mathrm{C_p}}\)</span>.</p></li>
</ol></li>
</ol>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation column-page-right">
  <div class="nav-page nav-page-previous">
      <a href="../correction/chap6.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">6 Variables qualitatives : ANCOVA et ANOVA</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../correction/chap8.html" class="pagination-link">
        <span class="nav-page-text">8 Régularisation des moindre carrés : Ridge, Lasso et elastic net</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>